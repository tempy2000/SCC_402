<html>

<head>
    <meta name="viewport" id="vp" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width" />
    <meta charset="utf-8" />

    <title>AR.js Basic Projected Camera Example</title>

    <!-- MazeMaps -->
    <link rel="stylesheet" href="https://api.mazemap.com/js/v2.0.9/mazemap.min.css">
    <script type='text/javascript' src='https://api.mazemap.com/js/v2.0.9/mazemap.min.js'></script>

    <!-- AR.js -->
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>

    <!-- Look-at component. We don't need this now, but we will later. -->
    <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
    <script type='text/javascript' src='MazeMapWithRouteEdit.js'></script>

   <!-- Scripts -->
   <script type="text/javascript" src="js/utils.js"></script>
   <script type="text/javascript" src="js/session-cookies.js"></script>
   <script type="text/javascript" src="js/logger.js"></script>
   <script type="text/javascript" src="js/route-system.js"></script>
   <script type="text/javascript" src="js/route.js"></script>

    <!-- Styles -->
    <link rel="stylesheet" href="css/stylesheet.css">

    <!-- Minimap Styles -->
    <style>
        body {
            margin: 0px;
            padding: 0px;
            width: 100%;
            height: 100%;
        }

        #map {
            top: auto;
            left: auto;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 35%;
            z-index: 9999999999999999999;
        }
    </style>
</head>

<body>
    <div id="map" class="mazemap"></div>

    <!-- Route selection buttons -->
    <div class="route-selector-container">
        <button id="btn-show-hide" class="ui-button">&gt</button>

        <div id="route-buttons">
            <button id="btn-route-a" class="ui-button">Route 1</button>
            <button id="btn-route-b" class="ui-button">Route 2</button>
            <button id="btn-route-c" class="ui-button">Route 3</button>
        </div>
    </div>

    <!-- Logging button -->
    <div class="logging-selector-container">
        <button id="btn-toggle-logging" class="ui-button">Start</button>
    </div>

    <!-- AR -->
    <a-scene vr-mode-ui="enabled: false"
        renderer="antialias: true; alpha: true;"
        arjs="sourceType: webcam; videoTexture: true; debugUIEnabled: false;">

        <!-- GLTF 2.0 Assets -->
        <a-assets>
            <a-asset-item id="marker-model" src="data/models/marker.gltf"></a-asset-item>
            <a-asset-item id="arrow-model" src="data/models/arrow.gltf"></a-asset-item>
        </a-assets>

        <!-- Camera -->
        <a-camera gps-projected-camera="minDistance: 5; maxDistance: 80;" rotation-reader></a-camera>

        <!-- Logger -->
        <a-entity logger="interval: 1000; batched: true; batchSize: 60"></a-entity>

        <!-- Routes -->
        <a-entity id="route-a"
            route="routePath: greggs-to-hotel.json; routeDirections: greggs-to-hotel.json;">
        </a-entity>
        <a-entity id="route-b"
            route="routePath: bhs-to-iss.json; routeDirections: bhs-to-iss.json;">
        </a-entity>
        <a-entity id="route-c"
            route="routePath: sports-centre-to-john-creed.json; routeDirections: sports-centre-to-john-creed.json;">
        </a-entity>
    </a-scene>

    <script>
        setAppId("Minimap");
        window.addEventListener("load", (evt) => {

            // Routing
            const btn_show_hide = document.querySelector("#btn-show-hide");
            const btn_route_buttons = document.querySelector("#route-buttons");

            // Toggling the route menu
            function toggle_route_menu(evt) {
                console.debug("[ui]: toggling route menu");

                if (btn_route_buttons.style.display !== "block") {
                    btn_route_buttons.style.display = "block";
                    btn_show_hide.textContent = "-";
                } else {
                    btn_route_buttons.style.display = "none";
                    btn_show_hide.textContent = ">";
                }
            }

            // Route menu button click handler
            btn_show_hide.addEventListener("click", toggle_route_menu, false);

            // Added "toggle-ability" to route buttons
            btn_route_buttons.querySelectorAll("button[id^=btn-route-]").forEach(btn => {
                btn.addEventListener("click", toggle_route_menu, false);
            });

            // Logging
            const btn_toggle_logging = document.querySelector("#btn-toggle-logging");

            window.addEventListener("logging-started", (evt) => {
                btn_toggle_logging.textContent = "Stop";
            });

            window.addEventListener("logging-terminated", (evt) => {
                btn_toggle_logging.textContent = "Start";
            });
        });
    </script>

    <script>
        const map = new Mazemap.Map({
            container: 'map',
            campuses: 341,
            center: {
                lat: 54.00530114985844,
                lng: -2.78520552873465
            },
            zoom: 18,
            zLevel: 3,
            scrollZoom: true,
            doubleClickZoom: false,
            touchZoomRotate: false,
        });

        // Add zoom and rotation controls to the map.
        map.addControl(new Mazemap.mapboxgl.NavigationControl());

        map.on("load", () => {
            fetch("../route-data-updated.json")
                .then(response => response.json())
                .then(geojson => map.route.setPath(geojson))
                .catch(err => console.error(err));
        });
    </script>
</body>

</html>
<!--<html>
<!DOCTYPE html>
<head>
    <meta name="viewport" id="vp" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width" />
    <meta charset="utf-8" />
    <script type='text/javascript' src='https://api.mazemap.com/js/v2.0.56/mazemap.min.js'></script>
    <link rel="stylesheet" href="https://api.mazemap.com/js/v2.0.56/mazemap.min.css">
  -->
<!-- include aframe -->
<!-- with location based, use aframe v0.9.2 -->
<!--<script src="https://aframe.io/releases/0.9.2/aframe.min.js"></script>-->
<!-- include ar.js -->
<!--<script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>-->
<!-- <script src="MazeMapWithRouteEdit.js"></script> -->
<!--<style>
        body { margin:0px; padding:0px; width: 100%; height:100%; }
    </style>
</head>
<body>
    <div id="map" class="mazemap"></div>


    <a-scene
        vr-mode-ui="enabled: false"
        embedded
        arjs="sourceType: webcam; debugUIEnabled: false;"
    >-->
<!-- latitude: <add-your-latitude>; longitude: <add-your-longitude>; -->
<!--"latitude: 54.005421; longitude: -2.785180;"-->
<!--<a-camera gps-camera rotation-reader> </a-camera>
    </a-scene>

    <script>
        const entity = document.createElement('a-text');
        entity.setAttribute('look-at', '[gps-projected-camera]');
        entity.setAttribute('value', "Test Item");
        entity.setAttribute('scale', {
            x: 120,
            y: 120,
            z: 120
        });
        entity.setAttribute('gps-projected-entity-place', {
                latitude: 54.00580783752977,
                longitude: -2.7859756350517273
            });
        document.querySelector("body > a-scene").appendChild(entity);

        const box = document.createElement('a-box');
        box.setAttribute('color', 'red');
        box.setAttribute('position', {x:0, y:2, z:-5});
        box.setAttribute('scale', {
            x: 2,
            y: 2,
            z: 2
        });
        box.setAttribute('gps-projected-entity-place', {
                latitude: 54.00580783752977,
                longitude: -2.7859756350517273
            });
        document.querySelector("body > a-scene").appendChild(box);


        const watchId = navigator.geolocation.watchPosition(position => {

            const { latitude, longitude } = position.coords;

            // 54.00580783752977, -2.7859756350517273
        });
    </script>
</body>
</html>-->
